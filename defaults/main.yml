---
# Zookeeper
zookeeper_client_port: "2181"
zookeeper_server_group: zookeeper_servers

zookeeper_peers_nodes: "
	{%- if zookeeper_peers is defined -%}
            {% for host in zookeeper_peers %}{{host}}:{{zookeeper_client_port}}{% if not loop.last %},{% endif %}{% endfor %}
	{%- else -%}
            {%- for host in groups[zookeeper_server_group] -%}{{hostvars[host]['ansible_default_ipv4']['address']}}:{{zookeeper_client_port}}{% if not loop.last %},{% endif %}{% endfor %} 
	{%- endif -%}
"

# Common
mesos_executor_registration_timeout: 10mins
mesos_cluster_name: "IndigoCluster"
mesos_ip: "{{ ansible_default_ipv4.address }}"
mesos_hostname: "{{ ansible_default_ipv4.address }}"

mesos_image_version: '1.11.0'

# Enable SSL
mesos_enable_ssl: false
mesos_ssl_cert_file: "{% if mesos_ssl_cert_gen == 'letsencrypt' %}/etc/letsencrypt/live/{{mesos_master_dns_name}}/fullchain.pem{% else %}/etc/mesos/server.crt{% endif %}" 
mesos_ssl_key_file: "{% if mesos_ssl_cert_gen == 'letsencrypt' %}/etc/letsencrypt/live/{{mesos_master_dns_name}}/privkey.pem{% else %}/etc/mesos/server.key{% endif %}"        
mesos_ssl_csr_file: /etc/mesos/server.csr
#mesos_ssl_cert_gen - allowed-values = self_signed, letsencrypt, none
mesos_ssl_cert_gen: none
mesos_master_dns_name:
mesos_certbot_admin_email:         
mesos_ssl_require_cert: false
mesos_ssl_support_downgrade: true
mesos_ssl_ciphers: ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256

# Defaults file for mesos-salve
mesos_slave_port: 5051
mesos_containerizers: "docker,mesos"
mesos_slave_work_dir: "/var/lib/mesos"
mesos_log_dir: "/var/log/mesos"
mesos_slave_image: "indigodatacloud/mesos-slave:{{ mesos_image_version }}"

mesos_enable_gpu_support: false

# Defaults file for mesos-master
mesos_zookeeper_group: zookeeper_servers
mesos_authenticate_http: true
mesos_username: 'admin'
mesos_password: 'admin'
mesos_master_port: 5050
mesos_master_work_dir: "/var/lib/mesos"
mesos_master_offer_timeout: 30secs
mesos_master_image: "marica/mesos-master:{{ mesos_image_version }}"

mesos_master_nodes: "
{%- if mesos_masters_list is defined -%}
    {{mesos_masters_list}}
{%- else -%}
    {{groups['mesos_masters']}}
{%- endif -%}"

# The Mesos quorum value is based on the number of Mesos Masters. Take the
# number of masters, divide by 2, and round-up to nearest integer. For example,
# if there are 1 or 2 masters the quorum count is 1. If there are 3 or 4
# masters then the quorum count is 2. For 5 or 6 masters it's 3 and so on.
mesos_quorum: "
{% if mesos_master_quorum is defined %}
{{ mesos_master_quorum }}
{% else %}
{{ ( mesos_master_nodes|count / 2) | round(0, 'ceil') | int }}
{%- endif -%}
"

mesos_deb_package_url: "https://stor.cloud.infn.it/v1/AUTH_b3794220f66f40aeb862e70d963b34e3/mesos-packages/mesos-1.11.0-1.ubuntu2004_amd64.deb"
mesos_package_dependencies:
  - openjdk-8-jre-headless 
  - libsvn1 
  - libcurl3-nss

# Debian
# mesos_agent_install_mode: package or docker
mesos_agent_install_mode: "package"

